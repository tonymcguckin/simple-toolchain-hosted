version: '2'

messages:
  $i18n: locales.yml

template:
  name:
    $ref: "$env.byoc_name === undefined ? '#/messages/template.name' : '#/messages/template.byoc_name'"

  description:
    $ref: "#/messages/template.description"

  getting_started:
      $ref: "#/messages/template.description"
  info:
    git url: >-
      $env.repository ? '[' + $env.repository + '](' + $env.repository + ')' : "[https://github.com/tonymcguckin/simple-toolchain-hosted](https://github.com/tonymcguckin/simple-toolchain-hosted)"
    git branch: >-
      $env.repository && $env.branch ? '[' + $env.branch + ']('+ $env.repository + '/tree/' + $env.branch + ')': "[flavour3](https://github.com/tonymcguckin/simple-toolchain-hosted/tree/flavour3)"

toolchain:
  name: "{{template.name}}"

services:
  repo:
    $switch:
      - $expr: default
      - $default: default
        service_id: orion
        parameters:
          env_id: "{{form.pipeline.parameters.env_id}}" 

form:
  pipeline:
    parameters:
      env_id: "'ENV_ID:' + $env.env_id"
    schema:
      $ref: deploy.json
